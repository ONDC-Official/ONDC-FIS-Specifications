search:
  context: &context
    $ref: "./context.yaml"
  message:
    intent:
      category:
        descriptor:
          code:
            $ref: './provider.yaml#/category_codes'
      descriptor:
        $ref: './category.yaml#/intente_descriptor'

            
on_search:
  context: *context
  message:
    catalog:
      providers:
        descriptor:
          code:
            $ref: "./provider.yaml#/provider_codes"
        categories:
          descriptor:
            code:
              $ref: "./provider.yaml#/category_codes"
        items: &item
          descriptor:
            code:
              $ref: "./item.yaml#/codes"
        fulfillments: &fulfillment
          type:
            $ref: "./fulfillment.yaml#/type"

select:
  context: *context
  message:
    order: &order
      items: *item
      fulfillments: *fulfillment

on_select:
  context: *context
  message:
    order: *order

init:
  context: *context
  message:
    order: &order1
      <<: *order
      payments: &payment
        $ref: "./payment.yaml"

on_init:
  context: *context
  message:
    order: &order2
      <<: *order1
      status:
        $ref: './order.yaml#/status'
      documents:
        descriptor:
          code:
            $ref: './document.yaml#/codes'

confirm:
  context: *context
  message:
    order: *order2

on_confirm:
  context: *context
  message:
    order: *order2

on_status:
  context: *context
  message:
    order: *order2

cancel:
  context: *context
  message:
    cancellation_reason_id:
      $ref: "./order.yaml#/cancellation_reason"